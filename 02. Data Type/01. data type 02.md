### 02. Predefined ABAP Type

-> ABAP Kernel 레벨에서 정의되어 있는 데이터 타입이며, 모든 ABAP 프로그램에서 사용할 수 있다.

프로그램에서 필요한 Local Type을 정의하기 위해 Predefined ABAP Type을 사용할 수 있다.



#### 1. 고정 길이를 가지는 기본 Predefined ABAP Type

ABAP은 고정 길이를 가지는 8가지 기본 Data Type을 제공하고 있다.

모든 필드 길이는 byte 단위로 구분된다.

데이터 타입 <u>D, F, I</u>는 이미 기술적 속성이 정의되어 있어서 <u>프로그램에서 필드 길이를 정의하지 않고 바로 사용</u>할 수 있다.

반면 일반적인 데이터 타입인 <u>C, N, X</u>를 사용할 때에는 <u>필드 길이를 정해야 한다.</u>

그리고 <u>TYPE P</u>는 <u>DECIMALS를 명시하지 않으면 소수자리를 인식하지 못한다.</u>

```abap
DATA gv_num TYPE I.
```

```abap
DATA gv_num TYPE p DECIMALS 2.
```

| 타입             | 초기길이 | 가능길이  | 초깃값     | 의미                                              |
| ---------------- | -------- | --------- | ---------- | ------------------------------------------------- |
| numeric types    |          |           |            |                                                   |
| I                | 4        | 4         | 0          | integer (whole number)                            |
| F                | 8        | 8         | 0          | Floating point number - 그냥 소수점 인식하는 숫자 |
| P                | 8        | 1 - 16    | 0          | Packed number                                     |
| character types  |          |           |            |                                                   |
| C                | 1        | 1 - 65535 | '...'      | Text Field (alphanumeric characters)              |
| D                | 8        | 8         | '00000000' | Date field (Format : YYYYMMDD)                    |
| N                | 1        | 1 - 65535 | '0....0'   | Numeric text field (numeric characters)           |
| T                | 6        | 6         | '000000'   | (format : HHMMSS)                                 |
| hexadecimal type |          |           |            |                                                   |
| X                | 1        | 1 - 65535 | X'0...0'   | Hexadecimal field                                 |



#### 2. Numeric Data Type



1. Integers (while numbers) of Type I

- 값의 범위는 -2^31 ~ 2^31-1
- 정수 타입만 지원
- 정수가 아닌 것은 반올림(Round)
- Counter, Item 수, Index 등에 쓰임



2. Packed numbers of Types P

- 소수 자리를 허용
- 가용 Size 1~16byte이며, 소수는 최대 14자리 설정 가능
- 프로그램 속성 Setting 시 Fixed point arithmetic 체크를 해야 한다. 그렇지 않을 경우 Type P는 Integer로 표현됨
- 정확한 계산을 요하는 Business Calculation 목적으로 사용됨



3. Floating point number of Type F

- 값의 범위는 1 * 10^-307 ~ 1 * 10^308
- 지수 형태로 표현되므로 FLTP_CHAR_CONVERSION과 같은 Function Module을 이용해 다른 데이터 타입으로 변환하여 출력함
- Type F는 내부적으로 Binary System으로 전환될 때 반올림 에러가 발생할 수 있음 (Rough Calculation)
- 높은 정확도를 요구한다면 Type P를 사용해야 하며, 매우 작거나 큰 수라면 Type F 사용을 권장함
- Value 범위가 넓은 경우나, 반올림 오류(rounding)가 중요한 사용이 아닐 경우 Type F를 사용함(실수 값에 대한 근삿값을 가지는 타입이기 때문에 주의)



Tip. Type F, I는 기계코드에 더 근접하기 때문에 연산 수행 시 Type F,I가 P보다 속도가 빠르다.

Tip2. 프로그램 생성 시 Fixed point arithmetic 체크하지 않고, Packed numbers를 연산에 사용하게 되면 소수점 자릿수를 무시하게 된다. 소수점 사용하고 싶을 시 체크 필수!

ex)

```abap
DATA gv_1 Type p DECIMALS 1 VALUE '1.1'.
DATA gv_2 Type p DECIMALS 1 VALUE '2.1'.
DATA gv_3 TYPE p.

gv_3 = gv_1 * gv_2.

WRITE gv_3.
```



#### 2.1 Numeric Data Type 더 살펴보기

위의 타입 외에 숫자를 표현할 수 있는 TYPE N이 존재하는데, 이것은 숫자 한 자리를 1byte로 표현하는 Character type이다.



1. TYPE I

2^32까지 수 표현 가능, 음수까지 포함하면 -2^31 ~ 2^31-1 범위의 수 표현 가능하다.



2. TYPE P

Two decimal digits are packed into one byte라는 영어 표현에서 TYPE P 유래되었다.

2자리 수가 1byte로 구성되고 마지막 자리 수는 부호를 포함하여 1byte로 표현된다.

즉, 16byte까지 사용할 수 있다는 것은 2 *12 = 32 자리 수까지 표현할 수 있다는 것.

대신 TYPE P 연산 시 소프트웨어 개입이 필요하기 때문에 TYPE I, F보다 속도가 느리다는 단점이 있다.

가용 Size라는 것은 변수명 다음에 변수 길이를 1~16byte 사이에 선언할 수 있다는 것이다.

```abap
DATA gv_p(16) TYPE P.
```

위처럼 괄호 안에 자리수를 선언하지 않으면 기본 8byte로 선언된다.

```abap
DATA gv_p TYPE P.
```

소수는 최대 14자리까지 사용할 수 있으며, 소수점을 표현할 때는 DECIMALS 옵셥 추가해야 한다.

```abap
DATA gv_p TYPE P DECIMALS 2. * 소수점 2자리 변수 선언
```



ex)

```abap
REPORT Z02_3

DATA gv_1 TYPE p. * 변수 길이 선언 X -> 디폴트 8byte = 15자리
DATA gv_2 TYPE p DECIMALS 14. * 소수점 14자리 변수 선언
DATA gv_3(16) TYPE p. * 1~16byte 사이 변수 선언

gv_1 = '123456789012345'
gv_2 = '0.12345678901234'
gv_3 = '1234567890123456789012345678901'

WRITE :/ gv_1.
WRITE :/ gv_2.
WRITE :/ gv_3.
```

만약 gv_1 = '1234567890123456'.처럼 TYPE p가 표현할 수 있는 길이를 넘어서게 되면

"Overflow when converting from 1234567890123456"라는 Overflow Dump Error가 발생하게 된다.



3. TYPE F

1 * 10^-307 ~ 1 * 10^308 범위이고, 지수 형태로 표현되므로 FLTP_CHAR_CONVERSION과 같은 Function Module을 이용해 다른 데이터 타입으로 변환하여 출력해야 한다.

Type F는 내부적으로 Binary System으로 전환될 때 반올림 에러(Rough Calculation)가 발생할 수 있다.

높은 정확도를 원한다면 Type p를 이용해야 한다.

매우 크거나 작은 수라면 Type f를 추천한다.



부동소수점(Floating Point Number)는 소수점 위치를 움직일 수 있게 함으로써 한정된 비트의 수로 정밀도를 보다 높게 표시할 수 있다.

ex) 12345 = 12345 X 10^0 or 1234500 X 10^-2 or 0.012345 X 10^6

그런데 예를 들어 123.45 X 10^+2에서 마지막 2자리 45는 지수를 위한 자릿수로 양보하게 된다.

그래서 부동소수점은 정밀도가 낮아져서 값이 유실될 수 있다.



#### 2.2 Numeric Operation (연산자)

1. Basic Arithmetic Operation 

| 기호 | 의미                    | 사용 예            | 기호와 동일한 키워드   |
| ---- | ----------------------- | ------------------ | ---------------------- |
| +    | 더하기                  | <p> = <n> + <m>.   | ADD <n> TO <m>.        |
| -    | 빼기                    | <p> = <m> - <n>.   | SUBTRACT <n> FROM <m>. |
| *    | 곱하기                  | <p> = <m> * <n>.   | MULTIPLY <m> BY <n>.   |
| /    | 나누기                  | <p> = <m> / <n>.   | DIVIDE <m> BY <n>.     |
| DIV  | Integer 나누기          | <p> = <m> DIV <n>. |                        |
| MOD  | Integer 나누기의 나머지 | <p> = <m> MOD <n>. |                        |
| **   | 제곱                    | <p> = <m> ** <n>.  |                        |



ex)

```ABAP
REPORT Z02_04.

DATA: gv_int1 TYPE i VALUE 2.
DATA: gv_int2 TYPE i VALUE 3.
DATA: gv_iresult TYPE i.

gv_iresult = gv_int1 + gv_int2.
WRITE : / '1 : ', gv_iresult.

ADD 1 TO gv_iresult.
WRITE : / '2 : ', gv_iresult.

DATA: gv_pack1 TYPE p DECIMALS 2 VALUE '2.17'.
DATA: gv_pack2 TYPE p DECIMALS 2 VALUE '5.43'.
DATA: gv_presult TYPE p DECIALS 2.

gv_presult = gv_pack2 / gv_pack2.
WRITE : / '3 : ', gv_presult.

MULTIPLY gv_presult by gv_pack2.
WRITE : / '4 : ', gv_presult.

DATA: gv_float1 TYPE f VALUE '1.337'.
DATA: gv_float2 TYPE f VALUE '2.7'.
DATA: gv_fresult TYPE f.
DATA: gv_cresult TYPE c LENGTH 16.

gv_fresult = gv_float2 * gv_float1.
WRTIE : / '5 : ', gv_fresult.

CALL FUNCTION 'FLTP_CHAR_CONVERSION'
	EXPORTING
		DECIM = 2
		INPUT = gv_fresult
	IMPORTING
		FLSTR = gv_cresult.

WRITE :/ '6 : ', gv_cresult. * TYPE f 사용 시 'FLTP_CHAR_CONVERSION' 함수 호출해 문자형으로 변환 후 출력해야 한다. 함수 호출 시 DECIM 파라미터에 숫자 전달 시 해당 소수점 자리의 결과를 반올림해서 보여준다.
```



2. Numeric Data Type 함수

| 함수  | 내역                                           | 사용예                          |
| ----- | ---------------------------------------------- | ------------------------------- |
| ABS   | 절댓값을 리턴한다.                             | ABS(-100) => 100                |
| SIGN  | 부호에 대한 결과를 리턴한다.                   | 마이너스 -1, 0 0, 플러스 + 리턴 |
| CEIL  | 해당 값보다 작지 않은 가장 큰 정수를 리턴한다. | CEIL(1.3) OR CEIL(1.7) => 2     |
| FLOOR | CEIL과 반대                                    | FLOOR(1.3) OR FLOOR(1.7) => 1   |
| TRUNC | 소수점을 버리고 정수만 남긴다.                 | TRUNC(1.3) OR FLOOR(1.7) => 1   |
| FRAC  | 소수점 이하 자리만 남긴다.                     | FRAC('2.9') => 0.9              |



3. Floating-Point 함수

| 함수                       | Meaning |
| -------------------------- | ------- |
| ACOS, ASIN, ATAN; COS, SIN |         |
|                            |         |
|                            |         |
|                            |         |
|                            |         |
|                            |         |

